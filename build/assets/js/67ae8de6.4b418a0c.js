"use strict";(self.webpackChunkga4gh_starter_kit_docs=self.webpackChunkga4gh_starter_kit_docs||[]).push([[486],{3905:function(e,t,n){n.d(t,{Zo:function(){return d},kt:function(){return k}});var a=n(7294);function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function o(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function i(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?o(Object(n),!0).forEach((function(t){r(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):o(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function s(e,t){if(null==e)return{};var n,a,r=function(e,t){if(null==e)return{};var n,a,r={},o=Object.keys(e);for(a=0;a<o.length;a++)n=o[a],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++)n=o[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var l=a.createContext({}),c=function(e){var t=a.useContext(l),n=t;return e&&(n="function"==typeof e?e(t):i(i({},t),e)),n},d=function(e){var t=c(e.components);return a.createElement(l.Provider,{value:t},e.children)},p="mdxType",u={inlineCode:"code",wrapper:function(e){var t=e.children;return a.createElement(a.Fragment,{},t)}},m=a.forwardRef((function(e,t){var n=e.components,r=e.mdxType,o=e.originalType,l=e.parentName,d=s(e,["components","mdxType","originalType","parentName"]),p=c(n),m=r,k=p["".concat(l,".").concat(m)]||p[m]||u[m]||o;return n?a.createElement(k,i(i({ref:t},d),{},{components:n})):a.createElement(k,i({ref:t},d))}));function k(e,t){var n=arguments,r=t&&t.mdxType;if("string"==typeof e||r){var o=n.length,i=new Array(o);i[0]=m;var s={};for(var l in t)hasOwnProperty.call(t,l)&&(s[l]=t[l]);s.originalType=e,s[p]="string"==typeof e?e:r,i[1]=s;for(var c=2;c<o;c++)i[c]=n[c];return a.createElement.apply(null,i)}return a.createElement.apply(null,n)}m.displayName="MDXCreateElement"},109:function(e,t,n){n.r(t),n.d(t,{assets:function(){return l},contentTitle:function(){return i},default:function(){return u},frontMatter:function(){return o},metadata:function(){return s},toc:function(){return c}});var a=n(3117),r=(n(7294),n(3905));const o={sidebar_position:1},i="Intro and Setup",s={unversionedId:"cookbooks/samtools-view-drs-wes/intro-and-setup",id:"cookbooks/samtools-view-drs-wes/intro-and-setup",title:"Intro and Setup",description:"In this cookbook, we will be running a very simple samtools view workflow on a small test dataset using two GA4GH standards: Worfklow Execution Service (WES) and Data Repository Service (DRS). Samtools is a command line application that is ubiquitous in bioinformatics and genomics. It is generally used to summarize, filter, and manipulate alignment data (in SAM, BAM, or CRAM format). Here, Samtools will simply be used to count the number of reads in some test BAM files.",source:"@site/docs/cookbooks/samtools-view-drs-wes/intro-and-setup.md",sourceDirName:"cookbooks/samtools-view-drs-wes",slug:"/cookbooks/samtools-view-drs-wes/intro-and-setup",permalink:"/docs/cookbooks/samtools-view-drs-wes/intro-and-setup",draft:!1,editUrl:"https://github.com/facebook/docusaurus/edit/master/website/docs/cookbooks/samtools-view-drs-wes/intro-and-setup.md",tags:[],version:"current",sidebarPosition:1,frontMatter:{sidebar_position:1},sidebar:"tutorialSidebar",previous:{title:"Intro to Cookbooks",permalink:"/docs/cookbooks/intro"},next:{title:"Run samtools view on WES with HTTP URLs as input",permalink:"/docs/cookbooks/samtools-view-drs-wes/run-using-http-urls"}},l={},c=[{value:"Starter Kit Service setup",id:"starter-kit-service-setup",level:2},{value:"Project directory",id:"project-directory",level:3},{value:"Database setup",id:"database-setup",level:3},{value:"WES: Create database tables",id:"wes-create-database-tables",level:4},{value:"DRS: Create database tables and add test dataset",id:"drs-create-database-tables-and-add-test-dataset",level:4},{value:"Service configuration",id:"service-configuration",level:3},{value:"WES YAML Configuration",id:"wes-yaml-configuration",level:4},{value:"DRS YAML Configuration",id:"drs-yaml-configuration",level:4},{value:"UI YAML Configuration",id:"ui-yaml-configuration",level:4},{value:"Run Services",id:"run-services",level:2},{value:"Run Services with docker-compose",id:"run-services-with-docker-compose",level:3},{value:"Explanation of the docker network",id:"explanation-of-the-docker-network",level:3},{value:"WES docker-compose.yml config",id:"wes-docker-composeyml-config",level:4},{value:"DRS docker-compose.yml config",id:"drs-docker-composeyml-config",level:4},{value:"Starter Kit UI docker-compose.yml config",id:"starter-kit-ui-docker-composeyml-config",level:4},{value:"Validate Services",id:"validate-services",level:2},{value:"Validate WES",id:"validate-wes",level:3},{value:"Validate DRS",id:"validate-drs",level:3},{value:"Validate Starter Kit UI",id:"validate-starter-kit-ui",level:3}],d={toc:c},p="wrapper";function u(e){let{components:t,...o}=e;return(0,r.kt)(p,(0,a.Z)({},d,o,{components:t,mdxType:"MDXLayout"}),(0,r.kt)("h1",{id:"intro-and-setup"},"Intro and Setup"),(0,r.kt)("p",null,"In this cookbook, we will be running a very simple ",(0,r.kt)("inlineCode",{parentName:"p"},"samtools view")," workflow on a small test dataset using two GA4GH standards: Worfklow Execution Service (WES) and Data Repository Service (DRS). ",(0,r.kt)("a",{parentName:"p",href:"http://www.htslib.org/"},"Samtools")," is a command line application that is ubiquitous in bioinformatics and genomics. It is generally used to summarize, filter, and manipulate alignment data (in SAM, BAM, or CRAM format). Here, Samtools will simply be used to count the number of reads in some test BAM files."),(0,r.kt)("p",null,"As mentioned above, we will set up two 2 starter kit services based on GA4GH API specifications:"),(0,r.kt)("ol",null,(0,r.kt)("li",{parentName:"ol"},"Workflow Execution Service (WES) - we will trigger ",(0,r.kt)("inlineCode",{parentName:"li"},"samtools view")," workflow runs by submitting API requests to WES"),(0,r.kt)("li",{parentName:"ol"},"Data Repostory Service (DRS) - in the last part of this exercise, we will use DRS IDs and DRS URLs to provide a layer of indirection to the BAM file inputs of the workflow, allowing us to run the same workflow regardless of what cloud or local resources the input files are stored on.")),(0,r.kt)("p",null,"We will also use the Starter Kit UI to make manual changes to our DRS database using a web browser."),(0,r.kt)("p",null,"This cookbook assumes that:"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"docker and docker-compose are installed and updated on your local machine"),(0,r.kt)("li",{parentName:"ul"},"You have access to your local machine's command line terminal"),(0,r.kt)("li",{parentName:"ul"},"You have an API testing tool installed on your local machine (such as Postman).")),(0,r.kt)("h2",{id:"starter-kit-service-setup"},"Starter Kit Service setup"),(0,r.kt)("p",null,"Let's begin by configuring and running our two starter kit services: WES and DRS, as well as the UI service."),(0,r.kt)("h3",{id:"project-directory"},"Project directory"),(0,r.kt)("p",null,"Let's setup the project directory space. Using the terminal, create and navigate to an empty directory in a preferred workspace. For example, the project directory used for the sample commands in the docs is: ",(0,r.kt)("inlineCode",{parentName:"p"},"/Users/jadams/cookbooks/samtools_wes_drs"),"."),(0,r.kt)("p",null,"Create and navigate to project directory:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"mkdir -p /Users/jadams/cookbooks/samtools_wes_drs\ncd /Users/jadams/cookbooks/samtools_wes_drs\n")),(0,r.kt)("h3",{id:"database-setup"},"Database setup"),(0,r.kt)("p",null,"We will use simple SQLite databases as the database backend driving WES and DRS starter kit apps. The ",(0,r.kt)("inlineCode",{parentName:"p"},"ga4gh-starter-kit-utils")," app will allow us to easily create these databases with the correct tables to store the underlying GA4GH data models."),(0,r.kt)("p",null,"First, let's create two empty files that will eventually become our SQLite databases: one for WES and one for DRS."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"mkdir -p db/wes db/drs\ntouch db/wes/wes.demo.db db/drs/drs.demo.db\n")),(0,r.kt)("p",null,"Next, let's pull the ",(0,r.kt)("inlineCode",{parentName:"p"},"ga4gh-starter-kit-utils")," docker image if we haven't already:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"docker pull ga4gh/ga4gh-starter-kit-utils:0.1.0\n")),(0,r.kt)("p",null,(0,r.kt)("inlineCode",{parentName:"p"},"ga4gh-starter-kit-utils")," will help us create the necessary tables for the WES and DRS Starter Kit apps. "),(0,r.kt)("h4",{id:"wes-create-database-tables"},"WES: Create database tables"),(0,r.kt)("p",null,"First, let's see what migration sets we can apply for WES:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"docker run ga4gh/ga4gh-starter-kit-utils:0.1.0 database list-migrations wes\n")),(0,r.kt)("p",null,"Result:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"API Migration Signatures: wes\nwes@0.2.0\nwes@0.1.0\n")),(0,r.kt)("p",null,"The above result tells us that we can create tables based on the ",(0,r.kt)("inlineCode",{parentName:"p"},"0.2.0")," release of Starter Kit WES. Let's create these tables on the ",(0,r.kt)("inlineCode",{parentName:"p"},"wes.demo.db")," SQLite database:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"docker run \\\n    -v `pwd`/db/wes:/db \\\n    ga4gh/ga4gh-starter-kit-utils:0.1.0 \\\n    database \\\n    create-tables \\\n    -d jdbc:sqlite:/db/wes.demo.db \\\n    wes@0.2.0\n")),(0,r.kt)("p",null,"You may confirm the operation was successful by reviewing the contents of ",(0,r.kt)("inlineCode",{parentName:"p"},"wes.demo.db"),"."),(0,r.kt)("h4",{id:"drs-create-database-tables-and-add-test-dataset"},"DRS: Create database tables and add test dataset"),(0,r.kt)("p",null,"First, let's see what migration sets we can apply for DRS:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"docker run ga4gh/ga4gh-starter-kit-utils:0.1.0 database list-migrations drs\n")),(0,r.kt)("p",null,"Result:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"API Migration Signatures: drs\ndrs@0.1.9\n")),(0,r.kt)("p",null,"The above result tells us that we can create tables based on the ",(0,r.kt)("inlineCode",{parentName:"p"},"0.1.9")," release of Starter Kit DRS. Let's create these tables on the ",(0,r.kt)("inlineCode",{parentName:"p"},"drs.demo.db")," SQLite database:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"docker run \\\n    -v `pwd`/db/drs:/db \\\n    ga4gh/ga4gh-starter-kit-utils:0.1.0 \\\n    database \\\n    create-tables \\\n    -d jdbc:sqlite:/db/drs.demo.db \\\n    drs@0.1.9\n")),(0,r.kt)("p",null,"Next, let's add the DRS test dataset to ",(0,r.kt)("inlineCode",{parentName:"p"},"drs.demo.db"),":"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"docker run \\\n    -v `pwd`/db/drs:/db \\\n    ga4gh/ga4gh-starter-kit-utils:0.1.0 \\\n    database \\\n    add-test-dataset \\\n    -d jdbc:sqlite:/db/drs.demo.db \\\n    drs@0.1.9\n")),(0,r.kt)("p",null,"You may confirm the operations were successful by reviewing the contents of ",(0,r.kt)("inlineCode",{parentName:"p"},"drs.demo.db"),"."),(0,r.kt)("h3",{id:"service-configuration"},"Service configuration"),(0,r.kt)("p",null,"We plan to set up 3 web services via Docker:"),(0,r.kt)("ol",null,(0,r.kt)("li",{parentName:"ol"},"WES"),(0,r.kt)("li",{parentName:"ol"},"DRS"),(0,r.kt)("li",{parentName:"ol"},"Starter Kit UI")),(0,r.kt)("p",null,"For each service, we need to create custom YAML configuration files to ensure they run with the correct properties, such as listening port(s), database connections, and service info responses."),(0,r.kt)("p",null,"First, let's create three empty files that will eventually become our YAML configurations for each service:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"mkdir -p config/wes config/drs config/ui\ntouch config/wes/wes.config.yml config/drs/drs.config.yml config/ui/ui.config.yml\n")),(0,r.kt)("h4",{id:"wes-yaml-configuration"},"WES YAML Configuration"),(0,r.kt)("p",null,"Using a preferred text editor, write the following YAML config to ",(0,r.kt)("inlineCode",{parentName:"p"},"config/wes/wes.config.yml"),":"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"wes:\n  serverProps:\n    publicApiPort: 80\n    adminApiPort: 4501\n  databaseProps:\n   url: jdbc:sqlite:/db/wes.demo.db\n  serviceInfo:\n    id: org.ga4gh.starterkit.cookbook.samtools.wes\n    name: Starter Kit Demo WES Service\n    description: WES service for samtools view Starter Kit Cookbook\n")),(0,r.kt)("h4",{id:"drs-yaml-configuration"},"DRS YAML Configuration"),(0,r.kt)("p",null,"Using a preferred text editor, write the following YAML config to ",(0,r.kt)("inlineCode",{parentName:"p"},"config/drs/drs.config.yml"),":"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"drs:\n  serverProps:\n    hostname: drs-demo.ga4gh.org\n    publicApiPort: 80\n    publicApiCorsAllowedOrigins:\n      - '*'\n    publicApiCorsAllowedHeaders:\n      - '*'\n    adminApiPort: 4503\n    adminApiCorsAllowedOrigins:\n      - '*'\n    adminApiCorsAllowedHeaders:\n      - '*'\n  databaseProps:\n    url: jdbc:sqlite:/db/drs.demo.db\n    poolSize: 8\n  serviceInfo:\n    id: org.ga4gh.starterkit.cookbook.samtools.drs\n    name: Starter Kit Demo DRS Service\n    description: DRS service for samtools view Starter Kit Cookbook\n")),(0,r.kt)("h4",{id:"ui-yaml-configuration"},"UI YAML Configuration"),(0,r.kt)("p",null,"Using a preferred text editor, write the following YAML config to ",(0,r.kt)("inlineCode",{parentName:"p"},"config/ui/ui.config.yml"),":"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"starterKitUI:\n  port: 4504\n  services:\n    - serviceType: drs\n      publicURL: 'http://localhost:4502'\n      adminURL: 'http://localhost:4503'\n")),(0,r.kt)("p",null,"The above config points the UI to the DRS service, so that models controlled by DRS (i.e. DRS Objects) can be created and edited via the UI."),(0,r.kt)("h2",{id:"run-services"},"Run Services"),(0,r.kt)("p",null,"With our database and YAML configurations set up, we are ready to run each of the necessary web services."),(0,r.kt)("p",null,"First, let's pull the docker images we want to run if we haven't already:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"docker pull ga4gh/ga4gh-starter-kit-wes:0.2.0-nextflow\ndocker pull ga4gh/ga4gh-starter-kit-drs:0.2.0\ndocker pull ga4gh/ga4gh-starter-kit-ui:0.2.1\n")),(0,r.kt)("p",null,"For WES, we also need to create a working directory mount between the host and container. To start, we first create this directory on the host, e.g."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"mkdir -p /tmp/shared/wes\n")),(0,r.kt)("h3",{id:"run-services-with-docker-compose"},"Run Services with docker-compose"),(0,r.kt)("p",null,"We will use ",(0,r.kt)("inlineCode",{parentName:"p"},"docker-compose")," to spin up our 3 dockerized GA4GH services using a single YAML file."),(0,r.kt)("p",null,"In the project directory, create a file named ",(0,r.kt)("inlineCode",{parentName:"p"},"docker-compose.yml"),", e.g.:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"touch docker-compose.yml\n")),(0,r.kt)("p",null,"In a text editor, write the following YAML config to ",(0,r.kt)("inlineCode",{parentName:"p"},"docker-compose.yml"),":"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},'version: "3.9"\nservices:\n  wes-demo.ga4gh.org:\n    container_name: wes-demo.ga4gh.org\n    image: ga4gh/ga4gh-starter-kit-wes:0.2.0-nextflow\n    ports:\n      - "80:80"\n      - "4501:4501"\n    volumes:\n      - $PWD/db/wes:/db\n      - $PWD/config/wes:/config\n      - /var/run/docker.sock:/var/run/docker.sock\n      - /tmp/shared/wes:/tmp/shared/wes\n    working_dir: /tmp/shared/wes\n    command: -c /config/wes.config.yml\n  drs-demo.ga4gh.org:\n    container_name: drs-demo.ga4gh.org\n    image: ga4gh/ga4gh-starter-kit-drs:0.2.0\n    ports:\n      - "4502:80"\n      - "4503:4503"\n    volumes:\n      - $PWD/db/drs:/db\n      - $PWD/config/drs:/config\n    command: java -jar ga4gh-starter-kit-drs.jar -c /config/drs.config.yml\n  ui-demo.ga4gh.org:\n    container_name: ui-demo.ga4gh.org\n    image: ga4gh/ga4gh-starter-kit-ui:0.2.1\n    ports:\n      - "4504:4504"\n    volumes:\n      - $PWD/config/ui:/config\n    command: -c /config/ui.config.yml\n')),(0,r.kt)("p",null,"Finally, we can start our network of 3 services by simply running:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"docker-compose up\n")),(0,r.kt)("h3",{id:"explanation-of-the-docker-network"},"Explanation of the docker network"),(0,r.kt)("p",null,"Running the above steps just created a ",(0,r.kt)("strong",{parentName:"p"},"docker network")," of 3 services. With ",(0,r.kt)("inlineCode",{parentName:"p"},"docker-compose"),", each service sits within a single virtual network, meaning that one service can easily reach out to another service in the network by referencing the docker container name as if it were a domain name. In the last section of this cookbook, we will see WES making calls to DRS using its ",(0,r.kt)("inlineCode",{parentName:"p"},"container_name"),", i.e. ",(0,r.kt)("inlineCode",{parentName:"p"},"http://drs-demo.ga4gh.org")),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"Note:")," Since our API testing tool sits outside the docker network, the URLs we use to make test API calls will be different from the URLs used by one service in the network to reach another service. For example, to call the DRS service we use:"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"http://localhost:4502")," outside the docker network, i.e. from API testing tool"),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"http://drs-demo.ga4gh.org")," inside the docker network, i.e. from WES")),(0,r.kt)("p",null,"Next, let's quickly go over how each of our services are configured to run according to the contents of ",(0,r.kt)("inlineCode",{parentName:"p"},"docker-compose.yml"),"."),(0,r.kt)("h4",{id:"wes-docker-composeyml-config"},"WES docker-compose.yml config"),(0,r.kt)("p",null,"Recall the WES service snippet from `docker-compose.yml:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},'...\n  wes-demo.ga4gh.org:\n    container_name: wes-demo.ga4gh.org\n    image: ga4gh/ga4gh-starter-kit-wes:0.2.0-nextflow\n    ports:\n      - "80:80"\n      - "4501:4501"\n    volumes:\n      - $PWD/db/wes:/db\n      - $PWD/config/wes:/config\n      - /var/run/docker.sock:/var/run/docker.sock\n      - /tmp/shared/wes:/tmp/shared/wes\n    working_dir: /tmp/shared/wes\n    command: -c /config/wes.config.yml\n...\n')),(0,r.kt)("p",null,"The above configuration:"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"starts a Starter Kit WES container that is pre-bundled with Nextflow, so it is possible to submit Nextflow-based workflow run requests to WES."),(0,r.kt)("li",{parentName:"ul"},"exposes ports, enabling us to make API requests from outside the network"),(0,r.kt)("li",{parentName:"ul"},"mounts the SQLite database and YAML config passed to the server application"),(0,r.kt)("li",{parentName:"ul"},"mounts docker-specific files/directories, so that docker processes can be started from within the container (Nextflow starts its own docker containers for individual workflow runs)."),(0,r.kt)("li",{parentName:"ul"},"runs the Starter Kit WES application with the YAML config as input")),(0,r.kt)("h4",{id:"drs-docker-composeyml-config"},"DRS docker-compose.yml config"),(0,r.kt)("p",null,"Recall the DRS service snippet from ",(0,r.kt)("inlineCode",{parentName:"p"},"docker-compose.yml")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},'...\n  drs-demo.ga4gh.org:\n    container_name: drs-demo.ga4gh.org\n    image: ga4gh/ga4gh-starter-kit-drs:0.2.0\n    ports:\n      - "4502:80"\n      - "4503:4503"\n    volumes:\n      - $PWD/db/drs:/db\n      - $PWD/config/drs:/config\n    command: java -jar ga4gh-starter-kit-drs.jar -c /config/drs.config.yml\n...\n')),(0,r.kt)("p",null,"The above configuration:"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"starts a Starter Kit DRS container"),(0,r.kt)("li",{parentName:"ul"},"exposes ports, enabling us to make API requests from outside the network"),(0,r.kt)("li",{parentName:"ul"},"mounts the SQLite database and YAML config passed to the server application"),(0,r.kt)("li",{parentName:"ul"},"runs the Starter Kit DRS application with the YAML config as input")),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"NOTE"),": The ",(0,r.kt)("inlineCode",{parentName:"p"},"0.1.9")," DRS database schema we applied is compatible with the ",(0,r.kt)("inlineCode",{parentName:"p"},"0.2.0")," release of Starter Kit DRS."),(0,r.kt)("h4",{id:"starter-kit-ui-docker-composeyml-config"},"Starter Kit UI docker-compose.yml config"),(0,r.kt)("p",null,"Recall the UI service snippet from ",(0,r.kt)("inlineCode",{parentName:"p"},"docker-compose.yml")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},'...\n  ui-demo.ga4gh.org:\n    container_name: ui-demo.ga4gh.org\n    image: ga4gh/ga4gh-starter-kit-ui:0.2.1\n    ports:\n      - "4504:4504"\n    volumes:\n      - $PWD/config/ui:/config\n    command: -c /config/ui.config.yml\n')),(0,r.kt)("p",null,"The above configuration:"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"starts a Starter Kit UI container"),(0,r.kt)("li",{parentName:"ul"},"exports ports, enabling us to access the UI via web browser"),(0,r.kt)("li",{parentName:"ul"},"mounts the YAML config passed to the UI server application")),(0,r.kt)("h2",{id:"validate-services"},"Validate Services"),(0,r.kt)("p",null,"Now, let's validate each service is running correctly"),(0,r.kt)("h3",{id:"validate-wes"},"Validate WES"),(0,r.kt)("p",null,"Let's confirm the WES service is running correctly by checking its Service Info. Using a preferred API testing tool, submit the following request:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"GET http://localhost/ga4gh/wes/v1/service-info\n")),(0,r.kt)("p",null,"You should receive the following Service Info as a response:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},'{\n    "id": "org.ga4gh.starterkit.cookbook.samtools.wes",\n    "name": "Starter Kit Demo WES Service",\n    "description": "WES service for samtools view Starter Kit Cookbook",\n    "contactUrl": "mailto:info@ga4gh.org",\n    "documentationUrl": "https://github.com/ga4gh/ga4gh-starter-kit-wes",\n    "createdAt": "2020-01-15T12:00:00Z",\n    "updatedAt": "2020-01-15T12:00:00Z",\n    "environment": "test",\n    "version": "0.2.0",\n    "type": {\n        "group": "org.ga4gh",\n        "artifact": "wes",\n        "version": "1.0.1"\n    },\n    "organization": {\n        "name": "Global Alliance for Genomics and Health",\n        "url": "https://ga4gh.org"\n    },\n    "workflowTypeVersions": {\n        "NEXTFLOW": [\n            "21.04.0"\n        ]\n    },\n    "workflowEngineVersions": {\n        "NATIVE": ""\n    }\n}\n')),(0,r.kt)("p",null,"Note that the ",(0,r.kt)("inlineCode",{parentName:"p"},"id"),", ",(0,r.kt)("inlineCode",{parentName:"p"},"name"),", and ",(0,r.kt)("inlineCode",{parentName:"p"},"description")," fields are the same as what was specified in the YAML config."),(0,r.kt)("h3",{id:"validate-drs"},"Validate DRS"),(0,r.kt)("p",null,"Let's confirm the DRS service is running correctly by checking its Service Info. Using a preferred API testing tool, submit the following request:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"GET http://localhost:4502/ga4gh/drs/v1/service-info\n")),(0,r.kt)("p",null,"You should receive the following Service Info as a response:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},'{\n    "id": "org.ga4gh.starterkit.cookbook.samtools.drs",\n    "name": "Starter Kit Demo DRS Service",\n    "description": "DRS service for samtools view Starter Kit Cookbook",\n    "contactUrl": "mailto:info@ga4gh.org",\n    "documentationUrl": "https://github.com/ga4gh/ga4gh-starter-kit-drs",\n    "createdAt": "2020-01-15T12:00:00Z",\n    "updatedAt": "2020-01-15T12:00:00Z",\n    "environment": "test",\n    "version": "0.1.0",\n    "type": {\n        "group": "org.ga4gh",\n        "artifact": "drs",\n        "version": "1.1.0"\n    },\n    "organization": {\n        "name": "Global Alliance for Genomics and Health",\n        "url": "https://ga4gh.org"\n    }\n}\n')),(0,r.kt)("p",null,"Note that the ",(0,r.kt)("inlineCode",{parentName:"p"},"id"),", ",(0,r.kt)("inlineCode",{parentName:"p"},"name"),", and ",(0,r.kt)("inlineCode",{parentName:"p"},"description")," fields are the same as what was specified in the YAML config."),(0,r.kt)("p",null,"Since we added the test DRS dataset, we can also verify that the ",(0,r.kt)("inlineCode",{parentName:"p"},"/objects")," endpoint is working correctly by supplying the test ID ",(0,r.kt)("inlineCode",{parentName:"p"},"b8cd0667-2c33-4c9f-967b-161b905932c9"),". Submit the following request:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"GET http://localhost:4502/ga4gh/drs/v1/objects/b8cd0667-2c33-4c9f-967b-161b905932c9\n")),(0,r.kt)("p",null,"You should receive the following DRS Object response:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},'{\n    "id": "b8cd0667-2c33-4c9f-967b-161b905932c9",\n    "description": "Open dataset of 384 phenopackets",\n    "created_time": "2021-03-12T20:00:00Z",\n    "name": "phenopackets.test.dataset",\n    "size": 143601,\n    "updated_time": "2021-03-13T12:30:45Z",\n    "version": "1.0.0",\n    "checksums": [\n        {\n            "checksum": "8711d59ca4264b3e3d0ce16349d94d0ab8ce493e",\n            "type": "sha1"\n        },\n        {\n            "checksum": "930014c944b655323ade3f4b239178022bfb5443ef6b280a7d7d69292867d010",\n            "type": "sha256"\n        },\n        {\n            "checksum": "938b077a59b11ad6e5958f9f34148f18",\n            "type": "md5"\n        }\n    ],\n    "self_uri": "drs://drs-demo.ga4gh.org/b8cd0667-2c33-4c9f-967b-161b905932c9",\n    "contents": [\n        {\n            "name": "phenopackets.mundhofir.family",\n            "drs_uri": [\n                "drs://drs-demo.ga4gh.org/1af5cdcf-898c-4dbc-944e-1ac95e82c0ea"\n            ],\n            "id": "1af5cdcf-898c-4dbc-944e-1ac95e82c0ea"\n        },\n        {\n            "name": "phenopackets.zhang.family",\n            "drs_uri": [\n                "drs://drs-demo.ga4gh.org/355a74bd-6571-4d4a-8602-a9989936717f"\n            ],\n            "id": "355a74bd-6571-4d4a-8602-a9989936717f"\n        },\n        {\n            "name": "phenopackets.cao.family",\n            "drs_uri": [\n                "drs://drs-demo.ga4gh.org/a1dd4ae2-8d26-43b0-a199-342b64c7dff6"\n            ],\n            "id": "a1dd4ae2-8d26-43b0-a199-342b64c7dff6"\n        },\n        {\n            "name": "phenopackets.lalani.family",\n            "drs_uri": [\n                "drs://drs-demo.ga4gh.org/c69a3d6c-4a28-4b7c-b215-0782f8d62429"\n            ],\n            "id": "c69a3d6c-4a28-4b7c-b215-0782f8d62429"\n        }\n    ]\n}\n')),(0,r.kt)("h3",{id:"validate-starter-kit-ui"},"Validate Starter Kit UI"),(0,r.kt)("p",null,"Let's confirm the UI service is running correctly by visiting ",(0,r.kt)("inlineCode",{parentName:"p"},"http://localhost:4504/")," via web browser (such as Google Chrome). You should see the following landing page:"),(0,r.kt)("p",null,(0,r.kt)("img",{alt:"UI Landing",src:n(4948).Z,width:"1899",height:"857"})),(0,r.kt)("p",null,"If we navigate to the ",(0,r.kt)("inlineCode",{parentName:"p"},"/services"),' view (by clicking "Enter" -> "Get Started"), we should also see a single ',(0,r.kt)("strong",{parentName:"p"},"valid service"),", representing the Starter Kit DRS instance we spun up and pointed the UI to:"),(0,r.kt)("p",null,(0,r.kt)("img",{alt:"UI Services",src:n(4218).Z,width:"704",height:"618"})),(0,r.kt)("p",null,'Lastly, if we click the "View" button for the DRS service, we will be directed to the ',(0,r.kt)("inlineCode",{parentName:"p"},"/services/org.ga4gh.starterkit.cookbook.samtools.drs")," view. This displays the DRS instance's Service Info, and also leads to forms where we can create and edit DRS Objects for that instance."),(0,r.kt)("p",null,(0,r.kt)("img",{alt:"UI Service",src:n(5373).Z,width:"1122",height:"850"})),(0,r.kt)("p",null,"In the ",(0,r.kt)("a",{parentName:"p",href:"./run-using-http-urls"},"next phase"),", we will run a Nextflow-based ",(0,r.kt)("inlineCode",{parentName:"p"},"samtools view")," workflow using API calls to the WES service we set up."))}u.isMDXComponent=!0},4948:function(e,t,n){t.Z=n.p+"assets/images/ui-landing-0ce8c7bf99e145ae4df00bcfb246bb57.png"},5373:function(e,t,n){t.Z=n.p+"assets/images/ui-service-726a2608e6f759c47e6f12a0fbcd442a.png"},4218:function(e,t,n){t.Z=n.p+"assets/images/ui-services-3fecbe2e98d5dc49a77c2bc48e1ebd60.png"}}]);